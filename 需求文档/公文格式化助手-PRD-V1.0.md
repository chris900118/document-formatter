1. 产品需求文档 (PRD) - 公文格式化助手 V1.0 (MVP)

| 文档版本 | V1.0 (MVP - 最小可行产品) |
| 产品名称 | 公文格式化助手 (GongwenFormat Tool) |
| 产品经理 | 潇 (PM) |
| 目标 | 为企业/单位用户提供一个一键式的Word公文格式化工具，支持自定义规范，解决人工排版耗时且易出错的核心痛点。 |
| 技术架构 | 桌面端应用 (Electron + React + Python-Core) |

2. 产品背景与愿景

2.1 为什么 (Why) - 核心问题

在企业和政府单位，公文（如通知、报告、函件）具有极其严格的格式标准（如“成都兴城集团规范”所示）。这些标准极为细致，精确到字体、字号、行距、页码、乃至数字的字体。

当前痛点：

耗时耗力： 员工需要花费大量时间（10-30分钟/篇）进行枯燥的手动排版。

极易出错： 规范复杂，人工操作极易遗漏（例如忘记把数字改为Times New Roman）。

标准不一： 不同的单位、不同的文件类型，有不同的规范，难以记忆和管理。

2.2 愿景 (Vision)

我们旨在打造一个“智能排版助手”。用户只需专注于内容创作，排版工作“一键”交给工具，确保100%符合规范，极大提升行政办公效率和专业性。

3. 目标用户 (User Personas)

我们为V1.0定义两个核心用户画像：

3.1 核心用户：张丽 (行政文员/经办人)

画像： 25-40岁，公司行政部门或业务部门的文员、秘书、经办人。

工作： 每天需要撰写或处理2-5份公文。

痛点： “我最烦排版了，每次都要花20分钟检查字体行距，还总被领导打回来说格式不对。”

需求： “我希望能有一个工具，我把写好的稿子丢进去，它就自动帮我排好版。”

3.2 关键用户：王涛 (行政主管/IT管理员)

画像： 30-50岁，行政部门主管或IT部门负责人。

工作： 负责制定和推行公司的文档规范。

痛点： “我怎么保证我部门几十个人发出去的文件格式都是统一的？我需要一个标准。”

需求： “我希望能定义一套我们公司的专属规范，然后让所有人都用这个标准来处理文档。”

4. MVP 核心功能 (User Stories)

为了满足两位用户的核心需求，V1.0 (MVP) 必须实现以下功能。

关键前提假设 (CRITICAL ASSUMPTION)

为了让工具能准确识别“什么是标题”、“什么是正文”，我们假设 (要求) 用户在撰写Word初稿时，使用了Word的**“样式”**功能。

一级标题 必须应用Word的 标题 1 样式。

二级标题 必须应用Word的 标题 2 样式。

正文 必须应用Word的 正文 (Normal) 样式。

...
本工具的MVP核心逻辑是“样式转换器”，而不是“内容猜测器”。 (我们将在UI上明确引导用户)

Epic 1: 核心格式化流程 (满足 张丽)

User Story (US1.1): 作为一个行政文员 (张丽)，我希望可以在软件主界面拖拽或点击上传一个 .docx 文件。

User Story (US1.2): 作为一个行政文员，我希望能在主界面选择一个预设的格式规范 (例如 “成都兴城集团规范”)。

User Story (US1.3): 作为一个行政文员，我希望点击“开始处理”后，能看到一个处理状态 (如 Loading...)，并在几秒钟内完成处理。

User Story (US1.4): 作为一个行政文员，我希望处理完成后，能点击“下载”按钮，得到一个已完成格式化的新 .docx 文件 (例如 原文件名_formatted.docx)。

Epic 2: 规范管理 (满足 王涛)

User Story (US2.1): 作为一个行政主管 (王涛)，我希望能进入一个“规范管理”界面。

User Story (US2.2): 作为一个行政主管，我希望看到一个预设的规范列表 (V1.0至少内置 “成都兴城集团规范” 作为模板)，并且这个预设规范不可删除。

User Story (US2.3): 作为一个行政主管，我希望可以**“新建”**一套全新的格式规范 (Profile)。

User Story (US2.4): 作为一个行政主管，我希望在新建或编辑规范时，可以自定义以下所有参数：

规范名称 (例如: “XX公司2025版规范”)

文档标题 (映射到Word的 "Title" 样式): 字体, 字号, 行距, 段前/段后间距, 对齐方式 (居中)

主送单位 (映射到 "Heading 6" 或自定义样式): 字体, 字号, 行距, 对齐方式 (顶格)

正文 (映射到 "Normal" 样式): 字体, 字号, 行距 (固定值), 首行缩进 (2字符)

一级标题 (映射到 "Heading 1"): 字体, 字号, 行距

二级标题 (映射到 "Heading 2"): 字体, 字号, 行距

三级标题 (映射到 "Heading 3"): 字体, 字号, 行距

四级标题 (映射到 "Heading 4"): 字体, 字号, 行距

落款单位 (映射到 "Heading 7" 或自定义样式): 字体, 字号

落款日期 (映射到 "Heading 8" 或自定义样式): 字体, 字号

User Story (US2.5): 作为一个行政主管，我希望可以保存我的自定义规范，并在主界面 (US1.2) 的下拉列表中选择它。

User Story (US2.6): 作为一个行政主管，我希望可以编辑或删除我 自己 创建的规范。

Epic 3: 特殊规则处理器

User Story (US3.1): 作为一个用户，我希望工具能自动遍历文档中的所有阿拉伯数字 (0-9) 和英文字母 (a-z, A-Z)，并将它们的字体强制设置为 "Times New Roman"，而不影响周围的中文汉字字体。

User Story (US3.2): 作为一个用户，我希望工具能处理页码：首页不显示页码，从第二页开始显示页码 (页码格式为 - 2 -, - 3 - ... 居中)。

User Story (US3.3): 作为一个用户，我希望工具能自动识别附件（基于“附件：”关键词），并将其后的附件标题应用正确的样式（例如，附件标题使用“方正小标宋简体”二号字）。

5. 页面与流程设计 (Wireframes)

5.1 页面流程图

[主界面] -> (点击 "管理规范") -> [规范列表页] -> (点击 "新建/编辑") -> [规范编辑页]

5.2 页面1: 主界面 (Home)

布局: (采用你已有的Electron/Vite/Tailwind基础)

组件 1: 一个大的拖拽上传区域 (支持点击选择文件)。

组件 2: 文件上传后，显示文件名 document.docx。

组件 3: 一个下拉菜单 (Dropdown)，用于“选择格式规范”。

选项 1: 成都兴城集团规范 (预设)

选项 2: XX公司2025版规范 (用户自定义)

组件 4: 一个醒目的 "开始处理" 按钮 (CTA)。

组件 5: 处理中显示 Loading 动画或进度条。

组件 6: 处理完成后，"开始处理" 按钮变为 "下载已格式化的文档" 按钮。

组件 7 (导航): 顶部或侧边栏有 "首页" 和 "规范管理" 两个菜单项。

组件 8 (引导): 在上传区下方必须有明确的提示文字：“请确保您的Word文档已使用【样式】(如 标题1, 标题2, 正文) 来区分结构，否则工具可能无法正确识别。”

5.3 页面2: 规范管理 (Profile List)

布局: 一个列表页面。

组件 1: “新建规范” 按钮。

组件 2: 规范列表 (Table 或 Card 形式)。

[卡片 1]

标题: 成都兴城集团规范

类型: (预设)

操作: [查看] (预设的不能编辑删除，只能查看)

[卡片 2]

标题: XX公司2025版规范

类型: (自定义)

操作: [编辑] [删除]

5.4 页面3: 规范编辑/新建 (Profile Editor)

布局: 一个长表单 (Form)。

组件 1: 输入框: 规范名称

组件 2: 一个配置区域 (Tab或Accordion)，对应 US2.4 中的每一个可配置项 (标题、正文、一级标题...)

每个配置项 (例如 "一级标题"):

下拉框: 字体 (需预置方正、宋体、黑体等常见字体)

输入框: 字号 (如 22)

输入框: 行距 (如 28)

勾选框: [ ] 加粗

下拉框: 对齐方式 (左对齐, 居中, 右对齐)

输入框: 段前间距 (如 0)

输入框: 段后间距 (如 0)

组件 3: “保存规范” 按钮。

6. MVP 范围外的功能 (Future Iterations)

以下功能不在 V1.0 (MVP) 范围内，留待未来版本迭代：

批量处理： 同时处理一个文件夹内的所有文档。

智能识别 (V2.0 核心): 不依赖“样式”，而是使用正则表达式 (RegEx) 或 AI 来猜测文档结构 (例如 识别 ^一、 为一级标题)。

规范的导入/导出： 允许王涛将他配置好的规范 .json 文件导出，分享给同事导入使用。

字体检查器： 启动时检查用户电脑是否安装了规范所需的字体 (如 "方正小标宋")，若未安装则提示。

复杂规则 UI： 针对“标题梯形排列”、“页末红线”等无法自动化的规则，提供一个“手动微调 Checklist” 提示用户。

7. 核心技术约束 (NFR - Non-Functional Requirements)

安全性 (Security): 所有文档处理必须在用户本地完成。 用户的任何文件数据严禁上传到任何云端服务器。 (这是 Electron + 本地 Python 方案的最大优势)

性能 (Performance): 处理一个50页的常规文档，响应时间应在 10 秒以内。

平台 (Platform): V1.0 优先打包为 Windows .exe 程序。

易用性 (Usability): 界面必须极其简洁，"张丽" (非技术用户) 必须在不看说明书的情况下也能完成核心操作。