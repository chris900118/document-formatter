<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公文助手 - 智能清洗交互原型</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #94a3b8; overflow: hidden; }
        
        /* 滚动条 */
        .scroller::-webkit-scrollbar { width: 6px; }
        .scroller::-webkit-scrollbar-track { background: transparent; }
        .scroller::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 3px; }
        .scroller::-webkit-scrollbar-thumb:hover { background: #94A3B8; }

        /* 模拟 Modal 背景 */
        .modal-backdrop {
            position: fixed; inset: 0; background: rgba(0,0,0,0.5); 
            display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(2px);
        }

        /* 开关样式 */
        .toggle-checkbox:checked {
            right: 0; border-color: #165DFF;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #165DFF;
        }
        
        /* 抽屉动画 */
        .drawer-enter { transform: translateX(100%); }
        .drawer-enter-active { transform: translateX(0); }
        .drawer-exit { transform: translateX(0); }
        .drawer-exit-active { transform: translateX(100%); }

        /* 清洗项状态样式 */
        .clean-item { transition: all 0.2s; border: 1px solid transparent; }
        
        /* 状态：将被删除 (默认) */
        .status-delete .num-mark { 
            background-color: #FEE2E2; color: #DC2626; text-decoration: line-through; 
        }
        .status-delete:hover { background-color: #FEF2F2; }

        /* 状态：保留 (用户取消勾选) */
        .status-keep { 
            background-color: #FEFCE8; border-color: #FEF08A; 
        }
        .status-keep .num-mark { 
            background-color: transparent; color: #854D0E; font-weight: bold; text-decoration: none;
        }
        .status-keep .text-body { color: #854D0E; font-weight: 600; }

        /* 自定义复选框 */
        .custom-checkbox {
            appearance: none; width: 16px; height: 16px; 
            border: 1.5px solid #CBD5E1; border-radius: 4px;
            background-color: white; cursor: pointer; position: relative;
        }
        .custom-checkbox:checked { background-color: #165DFF; border-color: #165DFF; }
        .custom-checkbox:checked::after {
            content: ''; position: absolute; left: 4px; top: 1px; width: 5px; height: 9px;
            border: solid white; border-width: 0 2px 2px 0; transform: rotate(45deg);
        }
    </style>
</head>
<body>

    <!-- 模拟主界面背景 -->
    <div class="modal-backdrop">
        
        <!-- ================== 主弹窗：结构纠偏 ================== -->
        <div class="bg-white rounded-xl shadow-2xl w-[1000px] h-[700px] flex flex-col relative overflow-hidden">
            
            <!-- Header -->
            <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-white z-10">
                <div class="flex items-center gap-2">
                    <div class="bg-blue-100 p-1.5 rounded text-blue-600"><i data-lucide="file-edit" class="w-5 h-5"></i></div>
                    <h2 class="text-lg font-bold text-gray-800">结构纠偏确认</h2>
                </div>
                <button class="text-gray-400 hover:text-gray-600"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>

            <!-- Info Bar -->
            <div class="px-6 py-3 bg-blue-50 border-b border-blue-100 flex items-center gap-2 text-sm text-blue-800">
                <i data-lucide="info" class="w-4 h-4"></i>
                <span>共扫描到 <strong>34</strong> 个段落，当前显示 <strong>29</strong> 个（已过滤 5 个）。</span>
            </div>

            <!-- Toolbar -->
            <div class="p-6 pb-2">
                <div class="flex gap-4 mb-4">
                    <div class="relative flex-1">
                        <i data-lucide="search" class="absolute left-3 top-2.5 w-4 h-4 text-gray-400"></i>
                        <input type="text" placeholder="输入关键字筛选..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm">
                        批量纠偏
                    </button>
                </div>
                
                <!-- Filters (Visual Only) -->
                <div class="flex gap-4 text-sm text-gray-600 mb-4">
                    <div class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox"> <span>排除正文 (26)</span></div>
                    <div class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox"> <span>排除标题 1 (3)</span></div>
                </div>
            </div>

            <!-- Main Table Header (关键交互区) -->
            <div class="flex bg-gray-50 border-y border-gray-200 text-xs text-gray-500 font-medium px-6 py-3">
                <div class="w-20">字数</div>
                <div class="w-24">原样式</div>
                <div class="flex-1 pl-4">预览 (即时效果)</div>
                <div class="w-64 pl-4 flex items-center justify-between">
                    <span>目标规范</span>
                    
<!-- 交互组件：自动编号开关 + 清洗入口 -->
                    <div class="flex items-center gap-3 bg-white px-2 py-1 rounded border border-gray-200 shadow-sm">
                        <span class="text-gray-600">自动编号</span>
                        
                        <!-- Switch (已修复：改为了 label 标签，且事件绑定在 input 上) -->
                        <label class="relative inline-block w-8 h-4 cursor-pointer">
                            <input type="checkbox" id="auto-num-switch" class="sr-only peer" onchange="toggleAutoNumber()">
                            <div class="w-8 h-4 bg-gray-200 rounded-full peer-transition-colors peer-checked:bg-blue-600"></div>
                            <div class="absolute left-0.5 top-0.5 bg-white w-3 h-3 rounded-full transition-transform peer-checked:translate-x-4 shadow-sm"></div>
                        </label>

                        <!-- 清洗入口 (默认隐藏) -->
                        <!-- 注意：去掉了 hidden，改用 opacity/width 动画让出现更平滑，或者直接用 JS 控制 class -->
                        <button id="clean-btn" onclick="openDrawer()" class="hidden flex items-center gap-1 text-[10px] bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700 px-2 py-0.5 rounded transition-all border border-blue-100 ml-1">
                            <i data-lucide="eraser" class="w-3 h-3"></i>
                            清洗
                            <span class="bg-red-500 text-white rounded-full w-4 h-4 flex items-center justify-center scale-75">12</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Table Body (Dummy Data) -->
            <div class="flex-1 overflow-y-auto scroller bg-white px-6">
                <div class="divide-y divide-gray-100">
                    <!-- Row 1 -->
                    <div class="flex py-4 items-center text-sm hover:bg-gray-50">
                        <div class="w-20 text-gray-400">12</div>
                        <div class="w-24"><span class="bg-gray-100 text-gray-600 px-2 py-1 rounded text-xs">正文</span></div>
                        <div class="flex-1 pl-4 text-gray-800 font-medium">（配图：移动端展示效果）</div>
                        <div class="w-64 pl-4">
                            <div class="w-full border border-gray-300 rounded px-3 py-1.5 text-gray-600 bg-white">正文</div>
                        </div>
                    </div>
                    <!-- Row 2 -->
                    <div class="flex py-4 items-center text-sm hover:bg-gray-50 bg-blue-50/20">
                        <div class="w-20 text-gray-400">8</div>
                        <div class="w-24"><span class="bg-orange-100 text-orange-600 px-2 py-1 rounded text-xs">Normal</span></div>
                        <div class="flex-1 pl-4 text-gray-800 font-bold">1.1 项目建设目标</div>
                        <div class="w-64 pl-4">
                            <div class="w-full border border-blue-300 text-blue-600 rounded px-3 py-1.5 bg-white font-medium flex justify-between items-center">
                                二级标题 <i data-lucide="chevron-down" class="w-4 h-4 opacity-50"></i>
                            </div>
                        </div>
                    </div>
                     <!-- Row 3 -->
                     <div class="flex py-4 items-center text-sm hover:bg-gray-50 bg-blue-50/20">
                        <div class="w-20 text-gray-400">15</div>
                        <div class="w-24"><span class="bg-orange-100 text-orange-600 px-2 py-1 rounded text-xs">Normal</span></div>
                        <div class="flex-1 pl-4 text-gray-800 font-bold">2025. 年度规划</div>
                        <div class="w-64 pl-4">
                            <div class="w-full border border-blue-300 text-blue-600 rounded px-3 py-1.5 bg-white font-medium flex justify-between items-center">
                                二级标题 <i data-lucide="chevron-down" class="w-4 h-4 opacity-50"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- ================== 右侧抽屉 (核心功能) ================== -->
        <!-- 这里的 translate-x-full 是默认隐藏状态 -->
        <div id="cleaner-drawer" class="fixed top-0 right-0 h-full w-[400px] bg-white shadow-[-10px_0_30px_rgba(0,0,0,0.1)] z-[100] transform translate-x-full transition-transform duration-300 ease-out flex flex-col border-l border-gray-100">
            
            <!-- Drawer Header -->
            <div class="px-5 py-4 border-b border-gray-100 flex justify-between items-center bg-gradient-to-r from-blue-50/50 to-white">
                <div class="flex items-center gap-3">
                    <div class="bg-blue-100 p-2 rounded-lg text-blue-600 shadow-sm">
                        <i data-lucide="sparkles" class="w-5 h-5"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-900 text-base">手动编号清洗</h3>
                        <div class="flex items-center gap-2 mt-0.5">
                            <span class="w-1.5 h-1.5 rounded-full bg-green-500"></span>
                            <p class="text-xs text-gray-500">AI 识别完成</p>
                        </div>
                    </div>
                </div>
                <button onclick="closeDrawer()" class="p-2 hover:bg-gray-100 rounded-full text-gray-400 hover:text-gray-600 transition-colors">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>

            <!-- Drawer Alert -->
            <div class="px-5 pt-5">
                <div class="flex gap-3 p-3 bg-orange-50 border border-orange-100 rounded-lg text-xs text-orange-800 items-start">
                    <i data-lucide="alert-triangle" class="w-4 h-4 flex-shrink-0 mt-0.5 text-orange-500"></i>
                    <div class="leading-relaxed">
                        检测到 <strong class="text-orange-700">12</strong> 个段落包含手动编号。建议清除，否则可能出现 "1. 1. 标题" 的重复编号。
                    </div>
                </div>
            </div>

            <!-- Drawer List (Pattern Grouping) -->
            <div class="flex-1 overflow-y-auto p-5 space-y-6">
                
                <!-- Group A -->
                <div class="border border-gray-200 rounded-lg overflow-hidden bg-white shadow-sm">
                    <div class="px-3 py-2 bg-gray-50 border-b border-gray-200 flex justify-between items-center">
                        <span class="text-xs font-bold text-gray-600 flex items-center gap-2">
                            <span class="w-1.5 h-1.5 rounded-full bg-indigo-500"></span>
                            数字 + 点 (1. / 2. ...)
                        </span>
                        <button class="text-xs text-blue-600 hover:underline">全选</button>
                    </div>
                    
                    <div class="divide-y divide-gray-50">
                        <!-- Item 1 (Default Delete) -->
                        <div class="status-delete p-3 flex items-start gap-3 cursor-pointer group" onclick="toggleItem(this)">
                            <input type="checkbox" class="custom-checkbox mt-0.5 flex-shrink-0" checked>
                            <div class="text-sm text-gray-600 leading-snug">
                                <span class="num-mark mr-1 px-1 rounded">1.1</span>
                                <span class="text-body">项目建设目标</span>
                            </div>
                        </div>

                        <!-- Item 2 (Risk Item) -->
                        <div id="risk-item" class="status-delete p-3 flex items-start gap-3 cursor-pointer group" onclick="toggleItem(this)">
                            <input type="checkbox" class="custom-checkbox mt-0.5 flex-shrink-0" checked>
                            <div class="text-sm text-gray-600 leading-snug">
                                <span class="num-mark mr-1 px-1 rounded">2025.</span>
                                <span class="text-body">年度规划与展望</span>
                            </div>
                            <!-- 这是一个隐藏的标记，用于保留后显示 -->
                            <span class="kept-badge hidden ml-auto text-[10px] bg-yellow-100 text-yellow-700 px-1.5 py-0.5 rounded font-bold whitespace-nowrap">已保留</span>
                        </div>

                        <!-- Item 3 -->
                        <div class="status-delete p-3 flex items-start gap-3 cursor-pointer group" onclick="toggleItem(this)">
                            <input type="checkbox" class="custom-checkbox mt-0.5 flex-shrink-0" checked>
                            <div class="text-sm text-gray-600 leading-snug">
                                <span class="num-mark mr-1 px-1 rounded">1.2</span>
                                <span class="text-body">实施路径</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Group B -->
                <div class="border border-gray-200 rounded-lg overflow-hidden bg-white shadow-sm opacity-90">
                    <div class="px-3 py-2 bg-gray-50 border-b border-gray-200 flex justify-between items-center">
                        <span class="text-xs font-bold text-gray-600 flex items-center gap-2">
                            <span class="w-1.5 h-1.5 rounded-full bg-purple-500"></span>
                            中文数字 (一、 / 二、)
                        </span>
                        <button class="text-xs text-blue-600 hover:underline">全选</button>
                    </div>
                    <div class="divide-y divide-gray-50">
                        <div class="status-delete p-3 flex items-start gap-3 cursor-pointer" onclick="toggleItem(this)">
                            <input type="checkbox" class="custom-checkbox mt-0.5 flex-shrink-0" checked>
                            <div class="text-sm text-gray-600 leading-snug">
                                <span class="num-mark mr-1 px-1 rounded">一、</span>
                                <span class="text-body">总体要求</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Drawer Footer -->
            <div class="p-5 border-t border-gray-200 bg-gray-50 flex gap-3 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] z-10">
                <button onclick="closeDrawer()" class="flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg text-sm font-medium hover:bg-white hover:border-gray-400 transition-all">
                    暂不处理
                </button>
                <button onclick="closeDrawer()" class="flex-[2] px-4 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 shadow-lg shadow-blue-500/30 transition-all flex items-center justify-center gap-2">
                    <i data-lucide="eraser" class="w-4 h-4"></i>
                    执行清除 (<span id="clean-count">11</span>)
                </button>
            </div>

        </div>

    </div>

    <script>
        lucide.createIcons();

        const drawer = document.getElementById('cleaner-drawer');
        const cleanBtn = document.getElementById('clean-btn');
        const switchInput = document.getElementById('auto-num-switch');

        // 切换自动编号开关
        function toggleAutoNumber() {
            const isChecked = switchInput.checked; // 获取点击后的状态
            if (isChecked) {
                cleanBtn.classList.remove('hidden');
            } else {
                cleanBtn.classList.add('hidden');
                closeDrawer(); // 关掉开关时如果抽屉开着，也要关掉
            }
        }

        // 抽屉控制
        function openDrawer() {
            drawer.classList.remove('translate-x-full');
        }

        function closeDrawer() {
            drawer.classList.add('translate-x-full');
        }

        // 列表项点击交互 (模拟红斑消除 vs 保留)
        function toggleItem(el) {
            const checkbox = el.querySelector('input');
            const badge = el.querySelector('.kept-badge');
            
            // 模拟点击 Checkbox (因为我们是点击 div 触发)
            // 实际 React 中不需要这样做，直接改 State
            setTimeout(() => {
                const isChecked = checkbox.checked; // 获取最新状态
                
                if (!isChecked) {
                    // 状态：保留 (Keep) -> 黄色
                    el.classList.remove('status-delete');
                    el.classList.add('status-keep');
                    if(badge) badge.classList.remove('hidden');
                    updateCount(-1);
                } else {
                    // 状态：删除 (Delete) -> 红色
                    el.classList.remove('status-keep');
                    el.classList.add('status-delete');
                    if(badge) badge.classList.add('hidden');
                    updateCount(1);
                }
            }, 0);
        }

        function updateCount(change) {
            const countEl = document.getElementById('clean-count');
            let val = parseInt(countEl.innerText);
            countEl.innerText = val + change;
        }
    </script>
</body>
</html>