<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公文格式化助手 - Pro Presentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Noto+Sans+SC:wght@300;400;500;700&family=JetBrains+Mono:wght@400&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Noto Sans SC', 'sans-serif'],
                        serif: ['Noto Serif SC', 'Songti SC', 'SimSun', 'serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        'official-red': '#ff0000',
                        'brand-blue': '#165DFF',
                        'dark-bg': '#0F172A',
                        'panel-bg': '#1E293B',
                    },
                    animation: {
                        'scan-down': 'scan-down 3s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        'scan-down': {
                            '0%': { top: '0%' },
                            '50%': { top: '100%' },
                            '100%': { top: '0%' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #0F172A;
            color: #fff;
            overflow: hidden;
        }

        .scroll-container {
            height: 100vh;
            width: 100vw;
            overflow-y: scroll;
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
        }

        .section {
            height: 100vh;
            width: 100%;
            scroll-snap-align: start;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .font-song {
            font-family: "FangSong", "FangSong_GB2312", "STFangsong", serif;
        }

        .font-hei {
            font-family: "SimHei", "STHeiti", sans-serif;
            font-weight: bold;
        }

        .font-kai {
            font-family: "KaiTi", "KaiTi_GB2312", "STKaiti", serif;
        }

        .font-bs {
            font-family: "FZXiaoBiaoSong-B05S", "SimSun", serif;
            font-weight: 900;
        }

        .fade-up {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease-out;
        }

        .visible .fade-up {
            opacity: 1;
            transform: translateY(0);
        }

        .delay-100 {
            transition-delay: 100ms;
        }

        .delay-200 {
            transition-delay: 200ms;
        }

        .delay-300 {
            transition-delay: 300ms;
        }

        /* --- Screen 2: 字体检测 --- */
        .font-check-card {
            width: 400px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            color: #333;
        }

        .check-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            border-bottom: 1px solid #F3F4F6;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.4s ease;
        }

        .check-item.show {
            opacity: 1;
            transform: translateX(0);
        }

        .scan-status-bar {
            height: 4px;
            background: #F3F4F6;
            width: 100%;
            overflow: hidden;
        }

        .scan-progress {
            height: 100%;
            background: #165DFF;
            width: 0%;
            transition: width 2s ease-in-out;
        }

        .result-alert {
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: none;
        }

        .result-alert.show {
            transform: scale(1);
            opacity: 1;
            display: flex;
        }

        /* --- Screen 3: 滑块 --- */
        .slider-stage {
            width: 800px;
            height: 1131px;
            max-height: 75vh;
            aspect-ratio: 210/297;
            position: relative;
            background: #fff;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            cursor: col-resize;
        }

        .layer-final {
            background: #fdfbf7;
            z-index: 2;
            clip-path: inset(0 0 0 50%);
            will-change: clip-path;
        }

        .slider-line {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 2px;
            background: #165DFF;
            z-index: 10;
            pointer-events: none;
            box-shadow: 0 0 15px #165DFF;
        }

        .slider-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 48px;
            height: 48px;
            background: #165DFF;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            z-index: 11;
            pointer-events: none;
        }

        /* --- Screen 6: AI HUD --- */
        .hud-box {
            position: absolute;
            border: 1px dashed rgba(22, 93, 255, 0.5);
            background: rgba(22, 93, 255, 0.05);
            transition: all 0.3s;
            cursor: default;
        }

        .hud-box:hover {
            border-color: #165DFF;
            background: rgba(22, 93, 255, 0.1);
        }

        .hud-tag {
            position: absolute;
            top: -20px;
            left: 0;
            font-size: 10px;
            background: #165DFF;
            color: white;
            padding: 2px 6px;
            border-radius: 2px;
            font-family: 'JetBrains Mono', monospace;
            display: flex;
            gap: 4px;
        }

        /* --- Common Elements --- */
        .clean-target {
            display: inline-block;
            color: #EF4444;
            background: rgba(239, 68, 68, 0.1);
            padding: 0 4px;
            border-radius: 2px;
            transition: all 0.5s;
            opacity: 1;
        }

        .clean-target.cleaned {
            opacity: 0;
            max-width: 0;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .auto-num {
            display: inline-block;
            color: #165DFF;
            font-weight: bold;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.3s;
            width: 0;
        }

        .auto-num.show {
            opacity: 1;
            transform: translateX(0);
            width: auto;
            margin-right: 8px;
        }

        /* --- 修复版：无黑框全宽输入交互 --- */

        /* 外层容器：负责显示“好看的框” */
        .editable-container {
            position: relative;
            width: 100%;
            /* 关键：撑满单元格宽度 */
            height: 100%;
            /* 撑满高度 */
            min-height: 48px;
            /* 给一个舒适的点击高度 */
            padding: 0 16px;
            /* 左右留白 */
            border-radius: 6px;
            border: 1px dashed transparent;
            /* 默认隐形 */
            display: flex;
            align-items: center;
            /* 垂直居中 */
            transition: all 0.2s ease;
            cursor: text;
            /* 提示可输入 */
        }

        /* 悬浮或激活时：显示外框 */
        .editable-container.active,
        .editable-container:hover {
            background-color: #ffffff;
            border-color: #165DFF;
            /* 蓝色边框 */
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            /* 浮起效果 */
        }

        /* 输入框本体：彻底去除“黑框”，只留文字 */
        .real-edit-input {
            flex: 1;
            /* 关键：占满容器剩余空间 */
            width: 100%;
            height: 100%;
            background: transparent;
            /* 透明背景 */
            border: none !important;
            /* 强制去边框 */
            outline: none !important;
            /* 强制去轮廓 */
            box-shadow: none !important;
            padding: 0;
            margin: 0;

            /* 继承字体设置 */
            font-family: inherit;
            font-size: inherit;
            font-weight: inherit;
            color: inherit;
        }

        /* 铅笔图标：悬浮显示 */
        .edit-icon-wrapper {
            opacity: 0;
            color: #165DFF;
            margin-left: 12px;
            transition: opacity 0.2s;
            flex-shrink: 0;
            /* 防止被挤压 */
        }

        .editable-container:hover .edit-icon-wrapper,
        .editable-container.active .edit-icon-wrapper {
            opacity: 1;
        }
    </style>
</head>

<body>

    <div class="scroll-container">

        <!-- SCREEN 1: 封面 -->
        <section class="section bg-slate-900 relative" id="page-1">
            <div class="absolute inset-0 bg-[url('https://assets.arco.design/img/bg.png')] bg-cover opacity-10"></div>
            <div class="text-center z-10 px-4">
                <div
                    class="mb-6 inline-flex items-center gap-2 px-4 py-1.5 border border-blue-500/30 bg-blue-500/10 rounded-full text-blue-400 text-sm font-medium fade-up">
                    <i data-lucide="cpu" class="w-4 h-4"></i>
                    <span>全新架构 · 智能重塑</span>
                </div>
                <h1
                    class="text-6xl md:text-8xl font-bold mb-6 bg-clip-text text-transparent bg-gradient-to-b from-white to-slate-500 fade-up delay-100">
                    公文美学<br>智能重塑
                </h1>
                <p class="text-xl text-slate-400 mb-10 font-light tracking-wide fade-up delay-200 font-mono">
                    Standardization · Intelligence · Privacy
                </p>
                <div class="fade-up delay-300 animate-bounce mt-10">
                    <i data-lucide="chevron-down" class="w-8 h-8 text-slate-500"></i>
                </div>
            </div>
        </section>

        <!-- SCREEN 2: [新增] 系统环境监测 -->
        <section class="section bg-[#0B0F19]" id="page-2">
            <div class="max-w-5xl w-full px-6 flex gap-16 items-center justify-center">
                <!-- Left: Copy -->
                <div class="w-1/2 text-right">
                    <div
                        class="inline-flex items-center gap-2 px-3 py-1 bg-orange-500/10 text-orange-400 rounded-full text-xs font-bold mb-4 border border-orange-500/20">
                        <i data-lucide="shield-check" class="w-3 h-3"></i> Environment Check
                    </div>
                    <h2 class="text-4xl font-bold mb-4 fade-up">字体环境监测</h2>
                    <p class="text-slate-400 fade-up delay-100 leading-relaxed">
                        排版错乱往往源于字体缺失。
                        <br>系统自动扫描本机字库，智能比对规范要求。
                        <br>在开始前，消灭潜在的“跑版”风险。
                    </p>
                </div>

                <!-- Right: UI Animation -->
                <div class="font-check-card fade-up delay-200 relative">
                    <!-- Header -->
                    <div class="px-6 py-4 border-b border-gray-100 bg-white flex justify-between items-center">
                        <span class="font-bold text-gray-800">系统工具箱</span>
                        <i data-lucide="wrench" class="w-4 h-4 text-blue-600"></i>
                    </div>
                    <!-- Scan Bar -->
                    <div class="scan-status-bar">
                        <div class="scan-progress" id="scan-progress"></div>
                    </div>

                    <!-- Content Area -->
                    <div class="p-6 min-h-[260px] bg-slate-50">
                        <!-- Result Alert -->
                        <div id="check-alert"
                            class="result-alert bg-red-50 border border-red-100 rounded-lg p-3 mb-4 flex items-start gap-3">
                            <i data-lucide="alert-circle" class="w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"></i>
                            <div>
                                <div class="text-red-800 font-bold text-sm">环境检测未通过</div>
                                <div class="text-red-600 text-xs mt-1">缺失核心字体，可能导致格式错误。</div>
                            </div>
                        </div>

                        <!-- Items -->
                        <div class="space-y-2" id="font-list">
                            <!-- Items injected by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SCREEN 3: [保留] 视觉对比 (Slider) -->
        <section class="section bg-[#1a1a1a]" id="page-3">
            <div class="absolute top-10 w-full text-center z-20 pointer-events-none">
                <h2 class="text-3xl font-bold text-white mb-2 fade-up">标准化的力量</h2>
                <p class="text-gray-400 text-sm fade-up delay-100">左侧：原始混乱草稿 &nbsp;|&nbsp; 右侧：国标红头公文</p>
            </div>

            <div class="slider-stage mt-12 fade-up delay-200" id="slider-stage">
                <!-- Layer 1: Final -->
                <div class="layer layer-final absolute inset-0 bg-[#fdfbf7] z-20" id="layer-final"
                    style="clip-path: inset(0 0 0 50%);">
                    <div class="p-12 text-black h-full relative flex flex-col">
                        <div class="text-center mb-8 pt-4">
                            <h1
                                class="text-[42px] leading-tight font-bs text-official-red tracking-widest scale-x-75 origin-center mb-4">
                                成都兴城投资集团有限公司文件</h1>
                            <div class="w-full h-[3px] bg-official-red mb-[2px]"></div>
                            <div class="w-full h-[1px] bg-official-red mb-8"></div>
                            <div class="flex justify-between font-song text-sm px-1">
                                <span>成兴发〔2025〕18号</span>
                                <span>签发人：张三</span>
                            </div>
                        </div>
                        <h2 class="text-2xl font-bs text-center mb-8 leading-relaxed">关于印发《公文格式化助手使用手册》的通知</h2>
                        <div class="text-lg font-song leading-[2em] text-justify flex-1">
                            <p class="mb-2 font-hei indent-0">各部门、各下属公司：</p>
                            <p class="indent-[2em] mb-2">现将《公文格式化助手使用手册》印发给你们，请结合实际认真贯彻执行。</p>
                            <p class="indent-[2em]">本工具旨在解决公文排版耗时、格式不统一等问题，实现一键标准化。</p>
                        </div>
                        <div class="mt-auto mb-12 right-16 self-end text-right font-song text-lg leading-[2em]">
                            <p>成都兴城投资集团有限公司</p>
                            <p>2025年11月24日</p>
                        </div>
                    </div>
                </div>
                <!-- Layer 2: Draft -->
                <div class="absolute inset-0 bg-white z-10 grayscale">
                    <div class="p-16 text-black font-sans">
                        <div class="bg-blue-900 text-white px-4 py-1 text-xs mb-12 w-fit">Word 草稿视图</div>
                        <h1 class="text-xl font-bold mb-4 text-left">关于印发《公文格式化助手使用手册》的通知</h1>
                        <p class="text-sm mb-6 text-gray-500">【文号：2025-001】</p>
                        <p class="font-bold text-base mb-2">各部门：</p>
                        <p class="text-base mb-4 leading-tight">
                            现将《公文格式化助手使用手册》印发给你们，请结合实际认真贯彻执行。现在的排版非常混乱，没有首行缩进，行间距也很挤。</p>
                        <p class="text-base mt-12 text-right">成都兴城投资集团有限公司<br>2025年11月</p>
                    </div>
                </div>
                <div class="slider-line" id="slider-line" style="left: 50%"></div>
                <div class="slider-button" id="slider-btn" style="left: 50%">
                    <i data-lucide="move-horizontal" class="w-6 h-6"></i>
                </div>
            </div>
        </section>

        <!-- SCREEN 4: [优化] 智能去杂 -->
        <section class="section bg-slate-900" id="page-4">
            <div class="max-w-6xl w-full px-6 grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                <div>
                    <div
                        class="inline-flex items-center gap-2 px-3 py-1 bg-red-500/10 text-red-400 rounded-full text-xs font-bold mb-4 border border-red-500/20">
                        <i data-lucide="eraser" class="w-3 h-3"></i> 智能预处理
                    </div>
                    <h2 class="text-4xl font-bold mb-6 fade-up">智能移除干扰项</h2>
                    <p class="text-slate-400 text-lg mb-8 leading-relaxed fade-up delay-100">
                        手动编号（如 "1.1"）是自动化的最大阻碍。
                        <br>引擎能精准识别这些<strong>“伪列表”</strong>并一键剔除，保留核心文本。
                    </p>
                    <button id="btn-clean"
                        class="px-6 py-3 bg-red-600 hover:bg-red-500 text-white rounded-lg shadow-lg shadow-red-600/20 transition-all flex items-center gap-2 active:scale-95 cursor-pointer z-20">
                        <i data-lucide="sparkles" class="w-5 h-5"></i>
                        <span>一键清洗演示</span>
                    </button>
                </div>

                <div
                    class="bg-panel-bg border border-slate-700 rounded-xl p-8 w-full fade-up delay-200 font-song text-lg shadow-2xl">
                    <div class="space-y-4" id="clean-list">
                        <div class="flex items-center bg-slate-800 p-4 rounded border border-slate-700">
                            <span class="clean-target font-mono">1.1</span>
                            <span class="text-slate-200">项目建设背景与意义</span>
                        </div>
                        <div class="flex items-center bg-slate-800 p-4 rounded border border-slate-700">
                            <span class="clean-target font-mono">（一）</span>
                            <span class="text-slate-200">指导思想与原则</span>
                        </div>
                        <div class="flex items-center bg-slate-800 p-4 rounded border border-slate-700">
                            <span class="clean-target font-mono">①</span>
                            <span class="text-slate-200">硬件设施采购清单</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SCREEN 5: 自动编号 -->
        <section class="section bg-slate-950" id="page-5">
            <div class="max-w-6xl w-full px-6 grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                <!-- Left: UI -->
                <div
                    class="order-2 md:order-1 bg-white rounded-xl shadow-2xl overflow-hidden fade-up delay-200 border border-slate-200 h-[420px] flex flex-col relative">
                    <div class="bg-slate-100 px-6 py-4 border-b border-slate-200 flex justify-between items-center">
                        <span class="text-sm font-bold text-slate-700 font-mono">AUTO_NUMBERING</span>
                        <div class="flex bg-white rounded-md p-1 border border-slate-300 shadow-sm gap-1">
                            <button onclick="toggleNum('zh')" id="btn-zh"
                                class="text-xs px-3 py-1.5 rounded font-medium bg-blue-600 text-white shadow-sm transition-all">国标
                                (一、)</button>
                            <button onclick="toggleNum('en')" id="btn-en"
                                class="text-xs px-3 py-1.5 rounded font-medium text-slate-600 hover:bg-slate-100 transition-all">技术
                                (1.1)</button>
                        </div>
                    </div>
                    <div class="p-8 bg-white font-song text-slate-800 flex-1 overflow-y-auto relative">
                        <div class="absolute left-[39px] top-10 bottom-10 w-px bg-slate-200 z-0"></div>
                        <div class="space-y-6 relative z-10">
                            <!-- L1 -->
                            <div class="flex items-center num-row">
                                <div class="w-2.5 h-2.5 bg-blue-600 rounded-full shadow-sm ring-4 ring-white z-10">
                                </div>
                                <div class="ml-4 flex items-center text-xl font-hei text-black">
                                    <span class="auto-num font-mono" data-zh="一、" data-en="1."></span>
                                    <span>总体建设方案</span>
                                </div>
                            </div>
                            <!-- L2 -->
                            <div class="flex items-center ml-[2px] num-row">
                                <div class="w-2 h-2 bg-blue-400 rounded-full shadow-sm ring-4 ring-white z-10"></div>
                                <div class="ml-6 flex items-center text-lg font-kai text-slate-800">
                                    <span class="auto-num font-mono" data-zh="（一）" data-en="1.1"></span>
                                    <span>建设目标</span>
                                </div>
                            </div>
                            <!-- L3 Group -->
                            <div class="ml-[3px] space-y-3 border-l-2 border-slate-100 pl-6 py-1">
                                <div class="flex items-center text-base font-song text-slate-600 num-row">
                                    <span class="auto-num font-mono" data-zh="1." data-en="1.1.1"></span>
                                    <span>短期目标</span>
                                </div>
                                <div class="flex items-center text-base font-song text-slate-600 num-row">
                                    <span class="auto-num font-mono" data-zh="2." data-en="1.1.2"></span>
                                    <span>长期规划</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right: Text -->
                <div class="order-1 md:order-2 text-left">
                    <div
                        class="inline-flex items-center gap-2 px-3 py-1 bg-blue-500/10 text-blue-400 rounded-full text-xs font-bold mb-4 border border-blue-500/20">
                        <i data-lucide="list-tree" class="w-3 h-3"></i> 逻辑闭环
                    </div>
                    <h2 class="text-4xl font-bold mb-6 fade-up">层级关系，自动重构</h2>
                    <p class="text-slate-400 text-lg mb-8 leading-relaxed fade-up delay-100">
                        清洗只是第一步。系统根据您的配置，自动为纯文本赋予层级关系。
                        <br>无论是 <span class="text-white font-mono bg-slate-800 px-1 rounded">1.1.1</span> 还是 <span
                            class="text-white font-mono bg-slate-800 px-1 rounded">一、(一) 1.</span>，都能自动递增，彻底告别手动维护编号的痛苦。
                    </p>
                </div>
            </div>
        </section>

        <!-- SCREEN 6: AI HUD (机器视觉) -->
        <section class="section bg-[#0F172A]" id="page-6">
            <div class="max-w-6xl w-full px-6 flex gap-16 items-center">
                <div class="w-1/2 text-right">
                    <div
                        class="inline-flex items-center gap-2 px-3 py-1 bg-purple-500/10 text-purple-400 rounded-full text-xs font-bold mb-4 border border-purple-500/20">
                        <i data-lucide="brain-circuit" class="w-3 h-3"></i> AI Kernel
                    </div>
                    <h2 class="text-4xl font-bold mb-4 fade-up">机器视觉语义分析</h2>
                    <p class="text-slate-400 mb-8 fade-up delay-100 leading-relaxed">
                        内置智能解析引擎，像人类一样“阅读”文档。
                        <br>精准识别段落语义、样式层级与格式特征。
                    </p>
                    <div class="flex flex-col gap-3 items-end fade-up delay-200 font-mono text-xs text-slate-400">
                        <div class="flex items-center gap-2">
                            <span>Confidence Score</span>
                            <div class="w-20 h-1 bg-purple-900 rounded overflow-hidden">
                                <div class="h-full bg-purple-500 w-[92%]"></div>
                            </div> 99.8%
                        </div>
                    </div>
                </div>

                <!-- AI HUD -->
                <div
                    class="w-1/2 relative h-[400px] bg-white rounded shadow-2xl fade-up delay-100 select-none overflow-hidden group">
                    <div class="absolute inset-0 p-8 text-black font-song text-sm opacity-80">
                        <p class="mb-6 text-center text-xl font-bs text-red-600">关于印发手册的通知</p>
                        <p class="mb-2">各部门：</p>
                        <p class="indent-8 leading-loose">现将手册印发给你们。请结合实际认真贯彻执行。</p>
                    </div>

                    <!-- HUD Overlay -->
                    <div class="absolute inset-0 bg-slate-900/10">
                        <!-- Box 1: Title -->
                        <div class="hud-box w-[80%] h-[60px] top-[20px] left-[10%]">
                            <div class="hud-tag">
                                <i data-lucide="scan-face" class="w-3 h-3"></i> Title
                            </div>
                        </div>
                        <!-- Box 2: Recipient -->
                        <div class="hud-box w-[30%] h-[30px] top-[90px] left-[8%]">
                            <div class="hud-tag bg-purple-600">
                                <i data-lucide="user" class="w-3 h-3"></i> Heading 6
                            </div>
                        </div>
                        <!-- Lines -->
                        <svg class="absolute inset-0 w-full h-full pointer-events-none opacity-50">
                            <line x1="50%" y1="50" x2="80%" y2="20" stroke="#165DFF" stroke-width="1" />
                            <circle cx="80%" cy="20" r="3" fill="#165DFF" />
                        </svg>
                        <!-- Data -->
                        <div
                            class="absolute top-5 right-5 text-[10px] font-mono text-blue-600 bg-white/90 p-2 rounded border border-blue-200 shadow-sm">
                            > Detecting...<br>
                            > Pattern: Red Header<br>
                            > Match: GB/T 9704
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SCREEN 7: 所见即所得 (无黑框完美版) -->
        <section class="section bg-slate-900" id="page-7">
            <div class="max-w-5xl w-full px-4">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold mb-4 fade-up">所见即所得</h2>
                    <p class="text-slate-400 fade-up delay-100">无需打开 Word，直接在软件内修订内容，样式即时生效。</p>
                </div>

                <div
                    class="bg-white rounded-xl shadow-2xl overflow-hidden border border-slate-200 fade-up delay-200 text-slate-800">
                    <!-- Header -->
                    <div
                        class="grid grid-cols-12 bg-slate-50 p-4 text-xs font-bold text-slate-500 border-b border-slate-200">
                        <div class="col-span-1 text-center">#</div>
                        <div class="col-span-7 pl-6">段落内容 (鼠标悬停即刻输入)</div>
                        <div class="col-span-4 pl-4">样式映射</div>
                    </div>

                    <!-- Row 1: 文档标题 (居中) -->
                    <div
                        class="grid grid-cols-12 border-b border-slate-100 group transition-colors h-24 items-center hover:bg-blue-50/30">
                        <div class="col-span-1 text-center text-slate-400 font-mono">1</div>

                        <!-- 编辑区 -->
                        <div class="col-span-7 px-4 h-full flex items-center">
                            <div class="editable-container hover-trigger">
                                <!-- 这里的 text-center 对应文档标题的居中样式 -->
                                <input type="text" value="关于进一步加强管理的通知"
                                    class="real-edit-input font-bs text-xl text-red-600 text-center">
                                <div class="edit-icon-wrapper">
                                    <i data-lucide="pencil" class="w-4 h-4"></i>
                                </div>
                            </div>
                        </div>

                        <div class="col-span-4 px-4">
                            <div
                                class="w-full border border-slate-300 rounded px-3 py-2 bg-white text-blue-600 text-sm font-bold flex justify-between items-center shadow-sm cursor-pointer hover:border-blue-500">
                                <span>文档标题</span>
                                <i data-lucide="chevron-down" class="w-4 h-4 opacity-50"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Row 2: 一级标题 (左对齐) -->
                    <div
                        class="grid grid-cols-12 border-b border-slate-100 group transition-colors h-24 items-center hover:bg-blue-50/30">
                        <div class="col-span-1 text-center text-slate-400 font-mono">2</div>

                        <!-- 编辑区 -->
                        <div class="col-span-7 px-4 h-full flex items-center">
                            <div class="editable-container hover-trigger">
                                <!-- 这里的 text-left 对应一级标题的左对齐 -->
                                <input type="text" value="一、总体要求"
                                    class="real-edit-input font-hei text-base text-black text-left">
                                <div class="edit-icon-wrapper">
                                    <i data-lucide="pencil" class="w-4 h-4"></i>
                                </div>
                            </div>
                        </div>

                        <div class="col-span-4 px-4">
                            <div
                                class="w-full border border-slate-300 rounded px-3 py-2 bg-white text-blue-600 text-sm font-bold flex justify-between items-center shadow-sm cursor-pointer hover:border-blue-500">
                                <span>一级标题</span>
                                <i data-lucide="chevron-down" class="w-4 h-4 opacity-50"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SCREEN 8: [更新] 规范配置 (深色) -->
        <section class="section bg-black" id="page-8">
            <div class="max-w-5xl w-full px-4 flex items-center justify-center gap-16">

                <!-- UI Panel (Dark Mode) -->
                <div
                    class="w-[450px] bg-[#1e1e1e] rounded-lg border border-[#3e3e3e] shadow-2xl overflow-hidden fade-up delay-100 font-sans text-sm">
                    <div class="bg-[#252526] px-4 py-3 border-b border-[#3e3e3e] text-gray-300">规范配置中心</div>
                    <div class="flex h-[340px]">
                        <div class="w-1/3 bg-[#252526] border-r border-[#3e3e3e] p-2 space-y-1">
                            <div class="bg-[#37373d] text-white p-2 rounded text-xs">成都兴城集团规范</div>
                            <div class="text-gray-400 p-2 rounded hover:bg-[#2a2d2e] text-xs cursor-pointer">国家行政公文标准
                            </div>
                            <div class="text-gray-400 p-2 rounded hover:bg-[#2a2d2e] text-xs cursor-pointer">企业内部通用模板
                            </div>
                        </div>
                        <div class="flex-1 p-6 bg-[#1e1e1e]">
                            <h3 class="text-white font-bold mb-6 pb-2 border-b border-[#3e3e3e]">字体映射规则</h3>
                            <div class="space-y-5">
                                <div class="flex gap-4">
                                    <div class="flex-1">
                                        <label class="text-gray-500 text-xs block mb-1.5">公文标题</label>
                                        <div
                                            class="bg-[#3c3c3c] text-gray-200 p-2.5 rounded border border-[#3e3e3e] text-xs">
                                            方正小标宋简体</div>
                                    </div>
                                    <div class="w-1/3">
                                        <label class="text-gray-500 text-xs block mb-1.5">字号</label>
                                        <div
                                            class="bg-[#3c3c3c] text-gray-200 p-2.5 rounded border border-[#3e3e3e] text-xs">
                                            22磅 (二号)</div>
                                    </div>
                                </div>
                                <div class="flex gap-4">
                                    <div class="flex-1">
                                        <label class="text-gray-500 text-xs block mb-1.5">一级标题</label>
                                        <div
                                            class="bg-[#3c3c3c] text-gray-200 p-2.5 rounded border border-[#3e3e3e] text-xs">
                                            黑体</div>
                                    </div>
                                    <div class="w-1/3">
                                        <label class="text-gray-500 text-xs block mb-1.5">字号</label>
                                        <div
                                            class="bg-[#3c3c3c] text-gray-200 p-2.5 rounded border border-[#3e3e3e] text-xs">
                                            16磅 (三号)</div>
                                    </div>
                                </div>
                                <div class="pt-2 flex items-center gap-3">
                                    <div
                                        class="w-9 h-5 bg-brand-blue rounded-full relative cursor-pointer shadow-inner">
                                        <div class="absolute right-0.5 top-0.5 w-3 h-3 bg-white rounded-full shadow-sm">
                                        </div>
                                    </div>
                                    <span class="text-gray-300 text-xs">启用西文自动修正</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Copy -->
                <div class="text-left w-[400px]">
                    <h2 class="text-3xl font-bold mb-6 fade-up">灵活配置，随心所欲</h2>
                    <p class="text-slate-400 text-base mb-8 leading-relaxed fade-up delay-100">
                        内置行业标准，亦支持深度微调。
                        <br><br>
                        从字体映射、行距倍数到页边距，一切配置均保存于本地，灵活适配不同公文场景。
                    </p>
                </div>
            </div>
        </section>

    </div>

    <script>
        lucide.createIcons();

        // --- Page 2: Font Check Animation ---
        function animateFontCheck() {
            const bar = document.getElementById('scan-progress');
            const list = document.getElementById('font-list');
            const alert = document.getElementById('check-alert');

            // Reset
            bar.style.width = '0%';
            list.innerHTML = '';
            alert.classList.remove('show');

            // Step 1: Scanning
            setTimeout(() => { bar.style.width = '70%'; }, 100);

            // Step 2: Items appear
            const items = [
                { name: "方正黑体", status: "ok" },
                { name: "方正小标宋简体", status: "missing" },
                { name: "楷体_GB2312", status: "ok" },
                { name: "仿宋_GB2312", status: "missing" }
            ];

            items.forEach((item, i) => {
                setTimeout(() => {
                    const el = document.createElement('div');
                    el.className = `check-item show flex items-center justify-between p-3 rounded ${item.status === 'ok' ? 'bg-white' : 'bg-red-50/50'}`;
                    el.innerHTML = `
                        <div class="flex items-center gap-3">
                            <div class="w-2 h-2 rounded-full ${item.status === 'ok' ? 'bg-green-500' : 'bg-red-500'}"></div>
                            <span class="text-sm font-medium ${item.status === 'ok' ? 'text-gray-700' : 'text-red-700'}">${item.name}</span>
                        </div>
                        <span class="text-xs ${item.status === 'ok' ? 'text-green-600' : 'text-red-500'} font-bold">${item.status === 'ok' ? '已安装' : '未找到'}</span>
                    `;
                    list.appendChild(el);
                }, 800 + (i * 300));
            });

            // Step 3: Complete
            setTimeout(() => {
                bar.style.width = '100%';
                alert.classList.add('show');
            }, 2200);
        }

        // --- Page 3: Slider Logic ---
        const stage = document.getElementById('slider-stage');
        const finalLayer = document.getElementById('layer-final');
        const sliderLine = document.getElementById('slider-line');
        const sliderBtn = document.getElementById('slider-btn');
        let isDragging = false;

        stage.addEventListener('mousedown', (e) => { isDragging = true; requestAnimationFrame(() => updateSlider(e.clientX)); });
        window.addEventListener('mousemove', (e) => { if (isDragging) { e.preventDefault(); requestAnimationFrame(() => updateSlider(e.clientX)); } });
        window.addEventListener('mouseup', () => { isDragging = false; });

        function updateSlider(clientX) {
            const rect = stage.getBoundingClientRect();
            let percent = Math.max(0, Math.min(100, ((clientX - rect.left) / rect.width) * 100));
            finalLayer.style.clipPath = `inset(0 0 0 ${percent}%)`;
            sliderLine.style.left = `${percent}%`;
            sliderBtn.style.left = `${percent}%`;
        }

        // --- Page 4: Clean Logic ---
        document.getElementById('btn-clean').addEventListener('click', function () {
            const targets = document.querySelectorAll('.clean-target');
            const btn = this;
            btn.style.opacity = '0.5';
            targets.forEach((el, idx) => { setTimeout(() => el.classList.add('cleaned'), idx * 200); });
            setTimeout(() => {
                targets.forEach(el => el.classList.remove('cleaned'));
                btn.style.opacity = '1';
            }, 2500);
        });

        // --- Page 5: Numbering Logic ---
        function toggleNum(type) {
            const badges = document.querySelectorAll('.auto-num');
            const btnZh = document.getElementById('btn-zh');
            const btnEn = document.getElementById('btn-en');

            if (type === 'zh') {
                btnZh.classList.add('bg-blue-600', 'text-white'); btnZh.classList.remove('text-slate-600');
                btnEn.classList.remove('bg-blue-600', 'text-white'); btnEn.classList.add('text-slate-600');
            } else {
                btnEn.classList.add('bg-blue-600', 'text-white'); btnEn.classList.remove('text-slate-600');
                btnZh.classList.remove('bg-blue-600', 'text-white'); btnZh.classList.add('text-slate-600');
            }

            badges.forEach(el => {
                el.classList.remove('show');
                setTimeout(() => {
                    el.innerText = el.getAttribute(`data-${type}`);
                    el.classList.add('show');
                }, 200);
            });
        }
        setTimeout(() => toggleNum('zh'), 500);

        // --- Observer ---
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    if (entry.target.id === 'page-2') animateFontCheck();
                }
            });
        }, { threshold: 0.3 });
        document.querySelectorAll('.section').forEach(s => observer.observe(s));
        // --- Page 7: 悬浮自动聚焦逻辑 ---
        document.querySelectorAll('.hover-trigger').forEach(container => {
            const input = container.querySelector('input');

            container.addEventListener('mouseenter', () => {
                input.focus();
                // 可选：光标移到最后
                // const len = input.value.length;
                // input.setSelectionRange(len, len);
                container.classList.add('active');
            });

            container.addEventListener('mouseleave', () => {
                input.blur();
                container.classList.remove('active');
            });
        });
    </script>
</body>

</html>